[{"action":"SET_STATE_SCHEMA","input":{"scope":"global","schema":"type TaskState { id: OID! title: String description: String assignee: String status: String createdAt: DateTime! dueDate: DateTime relatedProposalId: OID }"}},{"action":"ADD_OPERATION","input":{"name":"ADD_TASK","description":"Initialize a new task document state.","inputSchema":"input AddTaskInput { id: OID! title: String description: String createdAt: DateTime! relatedProposalId: OID }","module":"main"}},{"action":"ADD_OPERATION_EXAMPLE","input":{"operation":"ADD_TASK","example":{"id":"OID:task:1","title":"Prepare Safe migration plan","description":"Document step-by-step migration plan and required signers.","createdAt":"2026-02-06T09:00:00Z","relatedProposalId":"OID:proposal:1"}}},{"action":"ADD_OPERATION","input":{"name":"UPDATE_TASK","description":"Edit task fields.","inputSchema":"input UpdateTaskInput { id: OID! title: String description: String dueDate: DateTime }","module":"main"}},{"action":"ADD_OPERATION","input":{"name":"SET_TASK_STATUS","description":"Set task status.","inputSchema":"input SetTaskStatusInput { id: OID! status: String! }","module":"main"}},{"action":"ADD_OPERATION","input":{"name":"ASSIGN_TASK","description":"Assign or clear assignee.","inputSchema":"input AssignTaskInput { id: OID! assignee: String }","module":"main"}},{"action":"ADD_OPERATION_ERROR","input":{"operation":"ADD_TASK","code":"DUPLICATE_ID","name":"DuplicateIdError","description":"A task with the provided id already exists."}},{"action":"ADD_OPERATION_ERROR","input":{"operation":"SET_TASK_STATUS","code":"INVALID_STATUS","name":"InvalidStatusError","description":"Provided status is not allowed."}}]
[{"action":"SET_STATE_SCHEMA","input":{"scope":"global","schema":"type TaskState { id: OID! title: String description: String assignee: String status: String createdAt: DateTime! dueDate: DateTime relatedProposalId: OID }"}},{"action":"ADD_OPERATION","input":{"name":"ADD_TASK","description":"Initialize a new task document state.","inputSchema":"input AddTaskInput { id: OID! title: String description: String createdAt: DateTime! relatedProposalId: OID }","module":"main"}},{"action":"SET_OPERATION_REDUCER","input":{"operation":"ADD_TASK","reducer":"// ADD_TASK reducer\nif (state.id) {\n  throw new DuplicateIdError(`Task with id ${action.input.id} already exists`);\n}\nstate.id = action.input.id;\nstate.title = action.input.title || null;\nstate.description = action.input.description || null;\nstate.assignee = null;\nstate.status = \"OPEN\";\nstate.createdAt = action.input.createdAt;\nstate.dueDate = action.input.dueDate || null;\nstate.relatedProposalId = action.input.relatedProposalId || null;\n"}}},{"action":"ADD_OPERATION_EXAMPLE","input":{"operation":"ADD_TASK","example":{"id":"OID:task:1","title":"Prepare Safe migration plan","description":"Document step-by-step migration plan and required signers.","createdAt":"2026-02-06T09:00:00Z","relatedProposalId":"OID:proposal:1"}}},{"action":"ADD_OPERATION","input":{"name":"UPDATE_TASK","description":"Edit task fields.","inputSchema":"input UpdateTaskInput { id: OID! title: String description: String dueDate: DateTime }","module":"main"}},{"action":"SET_OPERATION_REDUCER","input":{"operation":"UPDATE_TASK","reducer":"// UPDATE_TASK reducer\nif (!state.id || state.id !== action.input.id) {\n  throw new EntityNotFoundError(`Task ${action.input.id} not found`);\n}\nif (action.input.title !== undefined) state.title = action.input.title;\nif (action.input.description !== undefined) state.description = action.input.description;\nif (action.input.dueDate !== undefined) state.dueDate = action.input.dueDate;\n"}}},{"action":"ADD_OPERATION","input":{"name":"SET_TASK_STATUS","description":"Set task status.","inputSchema":"input SetTaskStatusInput { id: OID! status: String! }","module":"main"}},{"action":"SET_OPERATION_REDUCER","input":{"operation":"SET_TASK_STATUS","reducer":"// SET_TASK_STATUS reducer\nconst allowed = [\"OPEN\",\"IN_PROGRESS\",\"DONE\",\"CANCELLED\"];\nif (!state.id || state.id !== action.input.id) {\n  throw new EntityNotFoundError(`Task ${action.input.id} not found`);\n}\nif (!allowed.includes(action.input.status)) {\n  throw new InvalidStatusError(`Invalid status: ${action.input.status}`);\n}\nstate.status = action.input.status;\n"}}},{"action":"ADD_OPERATION","input":{"name":"ASSIGN_TASK","description":"Assign or clear assignee.","inputSchema":"input AssignTaskInput { id: OID! assignee: String }","module":"main"}},{"action":"SET_OPERATION_REDUCER","input":{"operation":"ASSIGN_TASK","reducer":"// ASSIGN_TASK reducer\nif (!state.id || state.id !== action.input.id) {\n  throw new EntityNotFoundError(`Task ${action.input.id} not found`);\n}\nstate.assignee = (action.input.assignee !== undefined) ? action.input.assignee : null;\n"}}},{"action":"ADD_OPERATION_ERROR","input":{"operation":"ADD_TASK","code":"DUPLICATE_ID","name":"DuplicateIdError","description":"A task with the provided id already exists."}},{"action":"ADD_OPERATION_ERROR","input":{"operation":"SET_TASK_STATUS","code":"INVALID_STATUS","name":"InvalidStatusError","description":"Provided status is not allowed."}}]
